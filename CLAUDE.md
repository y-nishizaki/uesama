# claude-shogun システム構成

## 概要
claude-shogunは、Claude Code + tmux を使ったマルチエージェント並列開発基盤である。
戦国時代の軍制をモチーフとした階層構造で、複数のプロジェクトを並行管理できる。

## 階層構造

```
上様（人間 / The Lord）
  │
  ▼ 指示
┌──────────────┐
│   SHOGUN     │ ← 将軍（プロジェクト統括）
│   (将軍)     │
└──────┬───────┘
       │ YAMLファイル経由
       ▼
┌──────────────┐
│    KARO      │ ← 家老（タスク管理・分配）
│   (家老)     │
└──────┬───────┘
       │ YAMLファイル経由
       ▼
┌───┬───┬───┬───┬───┬───┬───┬───┐
│A1 │A2 │A3 │A4 │A5 │A6 │A7 │A8 │ ← 足軽（実働部隊）
└───┴───┴───┴───┴───┴───┴───┴───┘
```

## 通信プロトコル

### イベント駆動通信（YAML + send-keys）
- ポーリング禁止（API代金節約のため）
- 指示・報告内容はYAMLファイルに書く
- 通知は tmux send-keys で相手を起こす（必ず Enter を使用、C-m 禁止）

### ファイル構成
```
config/projects.yaml              # プロジェクト一覧
status/master_status.yaml         # 全体進捗
queue/shogun_to_karo.yaml         # Shogun → Karo 指示
queue/tasks/ashigaru{N}.yaml      # Karo → Ashigaru 割当（各足軽専用）
queue/reports/ashigaru{N}_report.yaml  # Ashigaru → Karo 報告
dashboard.md                      # 人間用ダッシュボード
```

**注意**: 各足軽には専用のタスクファイル（queue/tasks/ashigaru1.yaml 等）がある。
これにより、足軽が他の足軽のタスクを誤って実行することを防ぐ。

## tmuxセッション構成

### shogunセッション（1ペイン）
- Pane 0: SHOGUN（将軍）

### multiagentセッション（9ペイン）
- Pane 0: karo（家老）
- Pane 1-8: ashigaru1-8（足軽）

## 言語設定

config/settings.yaml の `language` で言語を設定する。

```yaml
language: ja  # ja, en, es, zh, ko, fr, de 等
```

### language: ja の場合
戦国風日本語のみ。併記なし。
- 「はっ！」 - 了解
- 「承知つかまつった」 - 理解した
- 「任務完了でござる」 - タスク完了

### language: ja 以外の場合
戦国風日本語 + ユーザー言語の翻訳を括弧で併記。
- 「はっ！ (Ha!)」 - 了解
- 「承知つかまつった (Acknowledged!)」 - 理解した
- 「任務完了でござる (Task completed!)」 - タスク完了
- 「出陣いたす (Deploying!)」 - 作業開始
- 「申し上げます (Reporting!)」 - 報告

翻訳はユーザーの言語に合わせて自然な表現にする。

## 指示書
- instructions/shogun.md - 将軍の指示書
- instructions/karo.md - 家老の指示書
- instructions/ashigaru.md - 足軽の指示書
